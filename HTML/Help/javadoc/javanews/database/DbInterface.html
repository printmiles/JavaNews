<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_11) on Sun Jul 05 16:37:33 BST 2009 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
DbInterface (JavaNews - Javadoc)
</TITLE>

<META NAME="date" CONTENT="2009-07-05">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="DbInterface (JavaNews - Javadoc)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/DbInterface.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../javanews/database/SQLStatements.html" title="class in javanews.database"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?javanews/database/DbInterface.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="DbInterface.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
javanews.database</FONT>
<BR>
Class DbInterface</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>javanews.database.DbInterface</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>DbInterface</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
This class is used to perform interactions between the application and the back-end database.
 This class is the sole user of the SQLStatements class. The class establishes the link to the
 database through a DSN defined by the user.
 <p>It references two entries in the preferences file:
 <ul><li><code>javanews.dsn.name</code> - Contains the name of the database to connect to.</li>
 <li><code>javanews.db.type</code> - Contains the type of database being connected to.</li></ul>
<P>

<P>
<DL>
<DT><B>Version:</B></DT>
  <DD>1.000</DD>
<DT><B>Author:</B></DT>
  <DD>Alex Harris (email: Alexander.J.Harris(at)btinternet.com)</DD>
</DL>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#className">className</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The unique name of the logger within the application</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#comPort">comPort</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The identifying name of the attached COM port</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;java.sql.Connection</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#con">con</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Connection object used to attach to the database</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#dbType">dbType</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The type of database being connected to</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#DISCOVERED_DUPLICATES">DISCOVERED_DUPLICATES</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A constant value used to represent an issue where duplicates may have been found in a database index</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#DISCOVERED_LINK_MESSAGE">DISCOVERED_LINK_MESSAGE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A constant value used to represent a message having been received from a link that is classed as discovered</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#DISCOVERED_NEW_LINK">DISCOVERED_NEW_LINK</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A constant value used to represent a new link being discovered and added to the database</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#dsnName">dsnName</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name of the data source being used</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#ERROR_ENCOUNTERED">ERROR_ENCOUNTERED</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A constant value used to represent the event that an error has been encountered during the execution of a method</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;java.util.Hashtable&lt;java.lang.String,java.lang.String&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#htMessageDb">htMessageDb</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The message database containing recognised messages and their IDs from tblMessages within the back-end database</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#isClosing">isClosing</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Indicates whether the database connection is about to close</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#jdbcodbcBridge">jdbcodbcBridge</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The name fo the JDBC:ODBC bridge driver class</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;java.util.logging.Logger</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#log">log</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The logger to be used for writing messages to the application log</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#NO_ENTRIES_FOUND">NO_ENTRIES_FOUND</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A constant value used to represent no entries or results being returned from a method or query</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#odbcPrefix">odbcPrefix</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The prefix for data source names using the JDBC:ODBC bridge</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#returnedNewLinkID">returnedNewLinkID</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The ID of a discovered link requested as part of a search</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../javanews/database/SQLStatements.html" title="class in javanews.database">SQLStatements</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#sqlS">sqlS</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The class used to retrieve SQL commands for Statements and PreparedStatements</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#WORKED_OK">WORKED_OK</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A constant value used to represent the successful execution of a command or subroutine</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#DbInterface(java.lang.String)">DbInterface</A></B>(java.lang.String&nbsp;comPort)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a new instance of DbInterface used to run queries to the database</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#closeConnection()">closeConnection</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Closes the connection to the back-end database when the application closes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../javanews/object/table/GenericTable.html" title="class in javanews.object.table">GenericTable</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#createGenericTable(java.sql.PreparedStatement, java.lang.String)">createGenericTable</A></B>(java.sql.PreparedStatement&nbsp;pSt,
                   java.lang.String&nbsp;sql)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generates a GenericTable instance from the results returned from a query.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#doesDbExist()">doesDbExist</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attempts to connect to the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#findDiscoveredLinkID(java.lang.String, java.lang.String)">findDiscoveredLinkID</A></B>(java.lang.String&nbsp;pseName,
                     java.lang.String&nbsp;linkID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Used to find the unique identifier of a discovered link given the PSE name,
 link ID and (implicitly) the COM port which we're monitoring.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#findNewLink(java.lang.String, java.lang.String)">findNewLink</A></B>(java.lang.String&nbsp;pseName,
            java.lang.String&nbsp;linkID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Used to locate the ID of a discovered link given a PSE name and Link ID.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getCodexLinkID(java.lang.String, java.lang.String)">getCodexLinkID</A></B>(java.lang.String&nbsp;pseName,
               java.lang.String&nbsp;linkID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the ID of the Codex given the PSE Name and link ID.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getCodexLinks()">getCodexLinks</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Obtains a list of all recognised PSEs and links.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getComments(java.lang.String)">getComments</A></B>(java.lang.String&nbsp;messageID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a vector containing individual entries for each comment added to a
 given message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.sql.Connection</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getConnection()">getConnection</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Obtain an instance of Connection with which to interface with the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Hashtable&lt;java.lang.String,java.lang.String&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getDiscoveredLinkDetails(java.lang.String)">getDiscoveredLinkDetails</A></B>(java.lang.String&nbsp;uuid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a hashtable containing certain information about a newly discovered
 link that has been specified by the provided UUID (universally unique identifier)
 that identifies a single entry within the tblNewLinks table.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getMessageDefinition(java.lang.String)">getMessageDefinition</A></B>(java.lang.String&nbsp;messageID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string containing the definition of a given message.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Hashtable</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getMessageDetails(java.lang.String)">getMessageDetails</A></B>(java.lang.String&nbsp;uuid)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a hashtable containing certain information about a received message
 that has been specified by the provided UUID (universally unique identifier)
 that identifies a single entry within the tblReceivedMessages table.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../javanews/object/table/GenericTable.html" title="class in javanews.object.table">GenericTable</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getMessagesByDate(java.util.Calendar)">getMessagesByDate</A></B>(java.util.Calendar&nbsp;limit)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Searches for messages received between two dates, namely the supplied date and the current date/time.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../javanews/object/table/GenericTable.html" title="class in javanews.object.table">GenericTable</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getMessagesByLink(java.lang.String, java.lang.String)">getMessagesByLink</A></B>(java.lang.String&nbsp;pse,
                  java.lang.String&nbsp;link)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Searches for messages from a given link within a given PSE.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../javanews/object/table/GenericTable.html" title="class in javanews.object.table">GenericTable</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#getMessagesByPSE(java.lang.String)">getMessagesByPSE</A></B>(java.lang.String&nbsp;pse)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Searches for messages received from a PSE and any links configured on it.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.Vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#lookupCodexLink(java.lang.String)">lookupCodexLink</A></B>(java.lang.String&nbsp;codexID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the details of a recognised link given its identifier.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#lookupMessage(java.lang.String)">lookupMessage</A></B>(java.lang.String&nbsp;aMessage)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Examines the database for known severity 1 messages that can be generated
 from a PSE and link.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#messageDbPreload()">messageDbPreload</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Used to retrieve the contents of tblMessages from the database and load it
 into memory to reduce the number of queries and improve response times for
 the application.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#removeDiscoveredLink(java.lang.String)">removeDiscoveredLink</A></B>(java.lang.String&nbsp;id)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Removes a named entry from tblNewLinks (discovered links table)</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#storeComment(java.lang.String, java.lang.String)">storeComment</A></B>(java.lang.String&nbsp;messageID,
             java.lang.String&nbsp;comment)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stores a new comment added by a user within the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#storeMessage(java.lang.Object[])">storeMessage</A></B>(java.lang.Object[]&nbsp;aMsg)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Given a formatted message received through a COM port.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#storeNewLink(java.lang.String, java.lang.String)">storeNewLink</A></B>(java.lang.String&nbsp;pseName,
             java.lang.String&nbsp;linkID)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stores a discovered link in the tblNewLinks table within the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#storeNewRecognisedLink(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String)">storeNewRecognisedLink</A></B>(java.lang.String&nbsp;newId,
                       java.lang.String&nbsp;comPort,
                       java.lang.String&nbsp;pseName,
                       java.lang.String&nbsp;linkId,
                       java.lang.String&nbsp;details,
                       java.lang.String&nbsp;description)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stores a link within the recognised link table (tblCodexLinks) in the database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#updateDetailsAndDescription(java.lang.String, java.lang.String, java.lang.String)">updateDetailsAndDescription</A></B>(java.lang.String&nbsp;linkId,
                            java.lang.String&nbsp;details,
                            java.lang.String&nbsp;description)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Updates the details and description fields of a specific link within the
 recognised link table.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../javanews/database/DbInterface.html#updateLinkIDs(java.lang.String, java.lang.String)">updateLinkIDs</A></B>(java.lang.String&nbsp;recognisedId,
              java.lang.String&nbsp;discoveredId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Changes the values within the tblReceivedMessages table within the database
 for a discovered PSE link.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="jdbcodbcBridge"><!-- --></A><H3>
jdbcodbcBridge</H3>
<PRE>
private static final java.lang.String <B>jdbcodbcBridge</B></PRE>
<DL>
<DD>The name fo the JDBC:ODBC bridge driver class
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#javanews.database.DbInterface.jdbcodbcBridge">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="odbcPrefix"><!-- --></A><H3>
odbcPrefix</H3>
<PRE>
private static final java.lang.String <B>odbcPrefix</B></PRE>
<DL>
<DD>The prefix for data source names using the JDBC:ODBC bridge
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#javanews.database.DbInterface.odbcPrefix">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="dsnName"><!-- --></A><H3>
dsnName</H3>
<PRE>
private java.lang.String <B>dsnName</B></PRE>
<DL>
<DD>The name of the data source being used
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="dbType"><!-- --></A><H3>
dbType</H3>
<PRE>
private java.lang.String <B>dbType</B></PRE>
<DL>
<DD>The type of database being connected to
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="className"><!-- --></A><H3>
className</H3>
<PRE>
private static final java.lang.String <B>className</B></PRE>
<DL>
<DD>The unique name of the logger within the application
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#javanews.database.DbInterface.className">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="sqlS"><!-- --></A><H3>
sqlS</H3>
<PRE>
private <A HREF="../../javanews/database/SQLStatements.html" title="class in javanews.database">SQLStatements</A> <B>sqlS</B></PRE>
<DL>
<DD>The class used to retrieve SQL commands for Statements and PreparedStatements
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="comPort"><!-- --></A><H3>
comPort</H3>
<PRE>
private java.lang.String <B>comPort</B></PRE>
<DL>
<DD>The identifying name of the attached COM port
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="con"><!-- --></A><H3>
con</H3>
<PRE>
private static java.sql.Connection <B>con</B></PRE>
<DL>
<DD>The Connection object used to attach to the database
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="log"><!-- --></A><H3>
log</H3>
<PRE>
private static java.util.logging.Logger <B>log</B></PRE>
<DL>
<DD>The logger to be used for writing messages to the application log
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="WORKED_OK"><!-- --></A><H3>
WORKED_OK</H3>
<PRE>
private final int <B>WORKED_OK</B></PRE>
<DL>
<DD>A constant value used to represent the successful execution of a command or subroutine
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#javanews.database.DbInterface.WORKED_OK">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="DISCOVERED_NEW_LINK"><!-- --></A><H3>
DISCOVERED_NEW_LINK</H3>
<PRE>
private final int <B>DISCOVERED_NEW_LINK</B></PRE>
<DL>
<DD>A constant value used to represent a new link being discovered and added to the database
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#javanews.database.DbInterface.DISCOVERED_NEW_LINK">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="DISCOVERED_DUPLICATES"><!-- --></A><H3>
DISCOVERED_DUPLICATES</H3>
<PRE>
private final int <B>DISCOVERED_DUPLICATES</B></PRE>
<DL>
<DD>A constant value used to represent an issue where duplicates may have been found in a database index
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#javanews.database.DbInterface.DISCOVERED_DUPLICATES">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="ERROR_ENCOUNTERED"><!-- --></A><H3>
ERROR_ENCOUNTERED</H3>
<PRE>
private final int <B>ERROR_ENCOUNTERED</B></PRE>
<DL>
<DD>A constant value used to represent the event that an error has been encountered during the execution of a method
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#javanews.database.DbInterface.ERROR_ENCOUNTERED">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="NO_ENTRIES_FOUND"><!-- --></A><H3>
NO_ENTRIES_FOUND</H3>
<PRE>
private final int <B>NO_ENTRIES_FOUND</B></PRE>
<DL>
<DD>A constant value used to represent no entries or results being returned from a method or query
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#javanews.database.DbInterface.NO_ENTRIES_FOUND">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="DISCOVERED_LINK_MESSAGE"><!-- --></A><H3>
DISCOVERED_LINK_MESSAGE</H3>
<PRE>
private final int <B>DISCOVERED_LINK_MESSAGE</B></PRE>
<DL>
<DD>A constant value used to represent a message having been received from a link that is classed as discovered
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#javanews.database.DbInterface.DISCOVERED_LINK_MESSAGE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="returnedNewLinkID"><!-- --></A><H3>
returnedNewLinkID</H3>
<PRE>
private java.lang.String <B>returnedNewLinkID</B></PRE>
<DL>
<DD>The ID of a discovered link requested as part of a search
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="htMessageDb"><!-- --></A><H3>
htMessageDb</H3>
<PRE>
private static java.util.Hashtable&lt;java.lang.String,java.lang.String&gt; <B>htMessageDb</B></PRE>
<DL>
<DD>The message database containing recognised messages and their IDs from tblMessages within the back-end database
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="isClosing"><!-- --></A><H3>
isClosing</H3>
<PRE>
private static boolean <B>isClosing</B></PRE>
<DL>
<DD>Indicates whether the database connection is about to close
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="DbInterface(java.lang.String)"><!-- --></A><H3>
DbInterface</H3>
<PRE>
public <B>DbInterface</B>(java.lang.String&nbsp;comPort)</PRE>
<DL>
<DD>Creates a new instance of DbInterface used to run queries to the database
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>comPort</CODE> - The identifier of the COM port used for this instance.</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="messageDbPreload()"><!-- --></A><H3>
messageDbPreload</H3>
<PRE>
private void <B>messageDbPreload</B>()</PRE>
<DL>
<DD>Used to retrieve the contents of tblMessages from the database and load it
 into memory to reduce the number of queries and improve response times for
 the application.
 <p>The database that this creates is a Hashtable containing a message as it
 should be received as the key and the ID of the message within the table as
 the value. The database is then used by the lookupMessage method to retrieve
 the IDs.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="lookupMessage(java.lang.String)"><!-- --></A><H3>
lookupMessage</H3>
<PRE>
public java.lang.String <B>lookupMessage</B>(java.lang.String&nbsp;aMessage)</PRE>
<DL>
<DD>Examines the database for known severity 1 messages that can be generated
 from a PSE and link. Given a message received on a COM port this method
 attempts to relate the received message to one stored within the database.
 <p>This method returns the ID of a message within the database that can
 be stored against the received message to provide a definition of it for
 reference.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>aMessage</CODE> - The message received from the COM port
<DT><B>Returns:</B><DD>The ID of the related message</DL>
</DD>
</DL>
<HR>

<A NAME="lookupCodexLink(java.lang.String)"><!-- --></A><H3>
lookupCodexLink</H3>
<PRE>
public java.util.Vector <B>lookupCodexLink</B>(java.lang.String&nbsp;codexID)</PRE>
<DL>
<DD>Returns the details of a recognised link given its identifier.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>codexID</CODE> - The codex ID
<DT><B>Returns:</B><DD>A vector containing: the PSE name, port ID, details and description.</DL>
</DD>
</DL>
<HR>

<A NAME="getConnection()"><!-- --></A><H3>
getConnection</H3>
<PRE>
private java.sql.Connection <B>getConnection</B>()</PRE>
<DL>
<DD>Obtain an instance of Connection with which to interface with the database.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Connection - The new instance to use.</DL>
</DD>
</DL>
<HR>

<A NAME="storeComment(java.lang.String, java.lang.String)"><!-- --></A><H3>
storeComment</H3>
<PRE>
public int <B>storeComment</B>(java.lang.String&nbsp;messageID,
                        java.lang.String&nbsp;comment)</PRE>
<DL>
<DD>Stores a new comment added by a user within the database.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>messageID</CODE> - The identifier of the parent message<DD><CODE>comment</CODE> - The comment itself
<DT><B>Returns:</B><DD>The result of the function. See the class variables for more information.</DL>
</DD>
</DL>
<HR>

<A NAME="storeNewLink(java.lang.String, java.lang.String)"><!-- --></A><H3>
storeNewLink</H3>
<PRE>
private int <B>storeNewLink</B>(java.lang.String&nbsp;pseName,
                         java.lang.String&nbsp;linkID)</PRE>
<DL>
<DD>Stores a discovered link in the tblNewLinks table within the database. It returns
 an integer value describing the result of the functions execution.
 <p>The ID allocated to the newly stored link is stored in the private String
 variable returnedNewLinkID.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pseName</CODE> - The name of the PSE<DD><CODE>linkID</CODE> - The link ID
<DT><B>Returns:</B><DD>The result of the function. See the class variables for more information.</DL>
</DD>
</DL>
<HR>

<A NAME="findDiscoveredLinkID(java.lang.String, java.lang.String)"><!-- --></A><H3>
findDiscoveredLinkID</H3>
<PRE>
public java.lang.String <B>findDiscoveredLinkID</B>(java.lang.String&nbsp;pseName,
                                             java.lang.String&nbsp;linkID)</PRE>
<DL>
<DD>Used to find the unique identifier of a discovered link given the PSE name,
 link ID and (implicitly) the COM port which we're monitoring.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pseName</CODE> - The name of the PSE name<DD><CODE>linkID</CODE> - The link ID
<DT><B>Returns:</B><DD>The universally unique identifier of the requested link</DL>
</DD>
</DL>
<HR>

<A NAME="findNewLink(java.lang.String, java.lang.String)"><!-- --></A><H3>
findNewLink</H3>
<PRE>
private int <B>findNewLink</B>(java.lang.String&nbsp;pseName,
                        java.lang.String&nbsp;linkID)</PRE>
<DL>
<DD>Used to locate the ID of a discovered link given a PSE name and Link ID.
 <p>It returns a status code to represent the outcome of running the method.
 Valid codes that may be returned are:
 <ul>
   <li>NO_ENTRIES_FOUND - Denoting that no results were returned from the query</li>
   <li>WORKED_OK - Denoting that a single result was found in the table</li>
   <li>DISCOVERED_DUPLICATES - Denoting that two or more results were returned</li>
   <li>ERROR_ENCOUNTERED - Denoting an exception was thrown during the method's execution</li>
 </ul>
 If the method returns either WORKED_OK or DISCOVERED_DUPLICATES then the first result returned
 can be examined through the private String variable named returnedNewLinkID.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pseName</CODE> - The name of the PSE<DD><CODE>linkID</CODE> - The ID of the link
<DT><B>Returns:</B><DD>The status code indicating whether the method ran correctly and what type of results were encountered</DL>
</DD>
</DL>
<HR>

<A NAME="storeMessage(java.lang.Object[])"><!-- --></A><H3>
storeMessage</H3>
<PRE>
public int <B>storeMessage</B>(java.lang.Object[]&nbsp;aMsg)</PRE>
<DL>
<DD>Given a formatted message received through a COM port. Stores the information in the database.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>aMsg</CODE> - The formatted message to store.
<DT><B>Returns:</B><DD>The result of the operation:
 <ol>
 <li>Executed without any issues.</li>
 <li>Detected a new link to be added to the database.</li>
 <li>It detected duplicates in tblCodexLinks within the database. The index or table may be corrupted.</li>
 <li>An exception occurred during execution.</li>
 </ol></DL>
</DD>
</DL>
<HR>

<A NAME="getCodexLinkID(java.lang.String, java.lang.String)"><!-- --></A><H3>
getCodexLinkID</H3>
<PRE>
public java.lang.String <B>getCodexLinkID</B>(java.lang.String&nbsp;pseName,
                                       java.lang.String&nbsp;linkID)</PRE>
<DL>
<DD>Returns the ID of the Codex given the PSE Name and link ID.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pseName</CODE> - The name of the PSE we know<DD><CODE>linkID</CODE> - The name of the link we know
<DT><B>Returns:</B><DD>A string containing the Codex ID.</DL>
</DD>
</DL>
<HR>

<A NAME="getCodexLinks()"><!-- --></A><H3>
getCodexLinks</H3>
<PRE>
public java.util.Vector <B>getCodexLinks</B>()</PRE>
<DL>
<DD>Obtains a list of all recognised PSEs and links.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>The vector containing the PSE Name (String), and Port (String).</DL>
</DD>
</DL>
<HR>

<A NAME="getMessagesByDate(java.util.Calendar)"><!-- --></A><H3>
getMessagesByDate</H3>
<PRE>
public <A HREF="../../javanews/object/table/GenericTable.html" title="class in javanews.object.table">GenericTable</A> <B>getMessagesByDate</B>(java.util.Calendar&nbsp;limit)</PRE>
<DL>
<DD>Searches for messages received between two dates, namely the supplied date and the current date/time.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>limit</CODE> - The date from which the report should be run.
<DT><B>Returns:</B><DD>Whether the query has executed correctly and placed the results within the supplied ResultSet.<DT><B>See Also:</B><DD><A HREF="../../javanews/gui/internalframe/GenericFrame.html" title="class in javanews.gui.internalframe"><CODE>GenericFrame</CODE></A>, 
<CODE>Calendar</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getMessagesByPSE(java.lang.String)"><!-- --></A><H3>
getMessagesByPSE</H3>
<PRE>
public <A HREF="../../javanews/object/table/GenericTable.html" title="class in javanews.object.table">GenericTable</A> <B>getMessagesByPSE</B>(java.lang.String&nbsp;pse)</PRE>
<DL>
<DD>Searches for messages received from a PSE and any links configured on it.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pse</CODE> - The name of the PSE to search for.
<DT><B>Returns:</B><DD>An instance of GenericTable that can be placed within a GenericFrame.</DL>
</DD>
</DL>
<HR>

<A NAME="getMessagesByLink(java.lang.String, java.lang.String)"><!-- --></A><H3>
getMessagesByLink</H3>
<PRE>
public <A HREF="../../javanews/object/table/GenericTable.html" title="class in javanews.object.table">GenericTable</A> <B>getMessagesByLink</B>(java.lang.String&nbsp;pse,
                                      java.lang.String&nbsp;link)</PRE>
<DL>
<DD>Searches for messages from a given link within a given PSE. All messages originating
 from the link across all dates will be returned. <p>If the query returns no results
 then the table will contain a single row informing the user that no results have
 been returned.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pse</CODE> - The name of the PSE to be used<DD><CODE>link</CODE> - The ID of the PSE to be used
<DT><B>Returns:</B><DD>An instance of GenericTable containing the results of the query.<DT><B>See Also:</B><DD><A HREF="../../javanews/gui/internalframe/GenericFrame.html" title="class in javanews.gui.internalframe"><CODE>GenericFrame</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="createGenericTable(java.sql.PreparedStatement, java.lang.String)"><!-- --></A><H3>
createGenericTable</H3>
<PRE>
private <A HREF="../../javanews/object/table/GenericTable.html" title="class in javanews.object.table">GenericTable</A> <B>createGenericTable</B>(java.sql.PreparedStatement&nbsp;pSt,
                                        java.lang.String&nbsp;sql)</PRE>
<DL>
<DD>Generates a GenericTable instance from the results returned from a query.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pSt</CODE> - An instance of PreparedStatement that has already had its parameters set.<DD><CODE>sql</CODE> - The SQL command to be executed as a String. This is used for logging purposes.
<DT><B>Returns:</B><DD>An instance of the GenericTable contain data resulting from the statement's execution.<DT><B>See Also:</B><DD><A HREF="../../javanews/object/table/GenericTable.html" title="class in javanews.object.table"><CODE>GenericTable</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="getDiscoveredLinkDetails(java.lang.String)"><!-- --></A><H3>
getDiscoveredLinkDetails</H3>
<PRE>
public java.util.Hashtable&lt;java.lang.String,java.lang.String&gt; <B>getDiscoveredLinkDetails</B>(java.lang.String&nbsp;uuid)</PRE>
<DL>
<DD>Returns a hashtable containing certain information about a newly discovered
 link that has been specified by the provided UUID (universally unique identifier)
 that identifies a single entry within the tblNewLinks table.
 <p>Should the query return two entries using the same UUID the last of the
 two entries will be contained within the hashtable.
 <p>The contents of hashtable will contain the following keys with no value
 (an empty string )if there wasn't anything returned through the SQL query.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>uuid</CODE> - The identifier of the discovered link to be used
<DT><B>Returns:</B><DD>The hashtable containing the results of the query. If no matches
 found then the values will contain empty strings. The keys present within
 the hashtable will be:
 <ul>
   <li>PSEName - The name of the PSE</li>
   <li>LinkID - The link identifier</li>
 </ul></DL>
</DD>
</DL>
<HR>

<A NAME="getMessageDetails(java.lang.String)"><!-- --></A><H3>
getMessageDetails</H3>
<PRE>
public java.util.Hashtable <B>getMessageDetails</B>(java.lang.String&nbsp;uuid)</PRE>
<DL>
<DD>Returns a hashtable containing certain information about a received message
 that has been specified by the provided UUID (universally unique identifier)
 that identifies a single entry within the tblReceivedMessages table.
 <p>Should the query return two entries using the same UUID the last of the
 two entries will be contained within the hashtable.
 <p>The contents of hashtable will contain the following keys with no value
 (an empty string )if there wasn't anything returned through the SQL query.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>uuid</CODE> - The identifier of the received message to be used
<DT><B>Returns:</B><DD>The hashtable containing the results of the query. If no matches
 found then the values will contain empty strings. The keys present within
 the hashtable will be:
 <ul>
   <li>PSEId - A foreign key for the known PSE that sent the message <strong>This is mutually exclusive with the TempID in that both keys are present but only one will have a value</strong></li>
   <li>TempID - A foreign key for the discovered PSE that sent the message <strong>This is mutually exclusive with the PSEId in that both keys are present but only one will have a value</strong></li>
   <li>Severity - The severity of the received message</li>
   <li>AlarmDate - The date when the message was sent according to the far-end (PSE)</li>
   <li>ReceivedDate - The date when the message was entered into the database</li>
   <li>FullMessage - The full message contents received</li>
   <li>MessageID - The foreign key for the message definition</li>
 </ul></DL>
</DD>
</DL>
<HR>

<A NAME="getComments(java.lang.String)"><!-- --></A><H3>
getComments</H3>
<PRE>
public java.util.Vector <B>getComments</B>(java.lang.String&nbsp;messageID)</PRE>
<DL>
<DD>Returns a vector containing individual entries for each comment added to a
 given message.
 <p>Comments are stored in a three field String array containing the name of the
 person adding the comment, when the comment was added and the comment
 respectively.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>messageID</CODE> - The ID of the message to return comments for
<DT><B>Returns:</B><DD>The vector containing all of the comments for the given message</DL>
</DD>
</DL>
<HR>

<A NAME="getMessageDefinition(java.lang.String)"><!-- --></A><H3>
getMessageDefinition</H3>
<PRE>
public java.lang.String <B>getMessageDefinition</B>(java.lang.String&nbsp;messageID)</PRE>
<DL>
<DD>Returns a string containing the definition of a given message.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>messageID</CODE> - The ID of the message to return the definition for
<DT><B>Returns:</B><DD>The message's definition</DL>
</DD>
</DL>
<HR>

<A NAME="closeConnection()"><!-- --></A><H3>
closeConnection</H3>
<PRE>
public void <B>closeConnection</B>()</PRE>
<DL>
<DD>Closes the connection to the back-end database when the application closes.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="removeDiscoveredLink(java.lang.String)"><!-- --></A><H3>
removeDiscoveredLink</H3>
<PRE>
public int <B>removeDiscoveredLink</B>(java.lang.String&nbsp;id)</PRE>
<DL>
<DD>Removes a named entry from tblNewLinks (discovered links table)
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>id</CODE> - The unique identifier of the link to remove from the table.
<DT><B>Returns:</B><DD>The work code indicating whether the function executed successfully or not.</DL>
</DD>
</DL>
<HR>

<A NAME="storeNewRecognisedLink(java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
storeNewRecognisedLink</H3>
<PRE>
public int <B>storeNewRecognisedLink</B>(java.lang.String&nbsp;newId,
                                  java.lang.String&nbsp;comPort,
                                  java.lang.String&nbsp;pseName,
                                  java.lang.String&nbsp;linkId,
                                  java.lang.String&nbsp;details,
                                  java.lang.String&nbsp;description)</PRE>
<DL>
<DD>Stores a link within the recognised link table (tblCodexLinks) in the database.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>newId</CODE> - The universally unique identifier for the given link<DD><CODE>comPort</CODE> - The COM port that the link is expected to be reported through<DD><CODE>pseName</CODE> - The PSE name of the node the link is connected to<DD><CODE>linkId</CODE> - The name of the link<DD><CODE>details</CODE> - Any user supplied details to be stored with the link<DD><CODE>description</CODE> - Any additional user supplied information to be stored with the link
<DT><B>Returns:</B><DD>The work code indicating whether the function executed successfully or not.</DL>
</DD>
</DL>
<HR>

<A NAME="updateLinkIDs(java.lang.String, java.lang.String)"><!-- --></A><H3>
updateLinkIDs</H3>
<PRE>
public int <B>updateLinkIDs</B>(java.lang.String&nbsp;recognisedId,
                         java.lang.String&nbsp;discoveredId)</PRE>
<DL>
<DD>Changes the values within the tblReceivedMessages table within the database
 for a discovered PSE link. The function selects all instances within the table
 of records with a temporary (discovered link) ID equal to that of the supplied
 <code>discoveredId</code> argument. The values in the temporary ID field are removed
 (changed to '') and the <code>recognisedId</code> inserted into the recognised ID
 field of the record.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>recognisedId</CODE> - The recognised link ID to be attached to each record<DD><CODE>discoveredId</CODE> - The discovered link ID to be attached to each record
<DT><B>Returns:</B><DD>The work code indicating whether the function executed successfully or not.</DL>
</DD>
</DL>
<HR>

<A NAME="updateDetailsAndDescription(java.lang.String, java.lang.String, java.lang.String)"><!-- --></A><H3>
updateDetailsAndDescription</H3>
<PRE>
public int <B>updateDetailsAndDescription</B>(java.lang.String&nbsp;linkId,
                                       java.lang.String&nbsp;details,
                                       java.lang.String&nbsp;description)</PRE>
<DL>
<DD>Updates the details and description fields of a specific link within the
 recognised link table. The link is specified by the universally unique
 identifier supplied as an argument.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>linkId</CODE> - The identifier of the link to be updated<DD><CODE>details</CODE> - The new contents for the details field<DD><CODE>description</CODE> - The new contents for the description field
<DT><B>Returns:</B><DD>The work code indicating whether the function executed successfully or not.</DL>
</DD>
</DL>
<HR>

<A NAME="doesDbExist()"><!-- --></A><H3>
doesDbExist</H3>
<PRE>
public boolean <B>doesDbExist</B>()</PRE>
<DL>
<DD>Attempts to connect to the database. If this method encounters any problems
 while connecting to the database then false is returned to the caller.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Whether the database exists and can be connected to.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/DbInterface.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../javanews/database/SQLStatements.html" title="class in javanews.database"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?javanews/database/DbInterface.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="DbInterface.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
